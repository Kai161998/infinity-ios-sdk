<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>Embedded Browser Events Guide Document</title>

	<link rel="stylesheet" href="../../css/style.css">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1.4">
	<meta name="generator" content="appledoc 2.2.1 (build 1333)">
</head>
<body class="appledoc wt-document">
	<header>
		<div class="container" class="hide-in-xcode">
			
			<h1 id="library-title">
				<a href="../../index.html">WebtrendsSDK </a>
			</h1>

			<p id="developer-home">
				<a href="../../index.html">Webtrends</a>
			</p>
			
		</div>
	</header>

	<aside>
		<div class="container">
			<nav>
				<ul id="header-buttons" role="toolbar">
					<li><a href="../../index.html">Home</a></li>
				</ul>
			</nav>
		</div>
	</aside>

	<article>
		<div id="overview-contents" class="container">
			<div id="content">
				<main role="main">
					<h1 class="title">Embedded Browser Events Guide Document</h1>

					<p>The Webtrends SDK provides a method of sharing session information between a parent application, and an embedded UIWebView. After following the steps outlined in <a href="#implementation">Implementation</a>, any app implementing the iOS SDK will be able to see and log events generated by the <a href="http://help.webtrends.com/en/jstag/">Webtrends JavaScript tag</a>.</p>

<h2>Requirements</h2>

<p>The native app must implement the Webtrends Mobile Library for iOS, the web content must be tagged with the Webtrends JavaScript tag, and you must be familiar with iOS UIWebViews.</p>

<p><span id="implementation"></span></p>

<h2>Implementation</h2>

<h3>Using UIWebView</h3>

<p>If you don&rsquo;t need to do any web view delegation of your own, simply create a retained instance of <WTUIWebViewDelegate> and assign it to your webview before making any requests, as shown in <a href="#method1">Method 1</a>. If you do need your own delegate, you can follow the steps outlined in <a href="#method2">Method 2</a>.</p>

<p><span id="method1"></span></p>

<h4>Method 1 – Webtrends-supplied delegate</h4>

<div class="swift-code-sample"><pre><code>@IBOutlet weak var webView: UIWebView!

// This retained instance of WTUIWebViewDelegate will do all the legwork for us.
let wtDelegate = WTUIWebViewDelegate()

override func viewDidLoad() {
    super.viewDidLoad()
    let url = NSURL(string: "https://bank.wt-go.com/invest")
    
    // If you want to share a session between the app and the website,
    // append it to the URL before triggering the request
    // using the appendSessionParamsToUrl: method below
    let sessionedUrl = WTDataCollector.sharedCollector().appendSessionParamsToUrl(url)
    
    // Set our retained WTUIWebViewDelegate as the UIWebView's delegate
    webView.delegate = wtDelegate
        
    webView.loadRequest(NSURLRequest(URL: sessionedUrl))
}</code></pre></div>




<div class="objective_c-code-sample"><pre><code>@interface MyViewController ()

@property (weak, nonatomic) IBOutlet UIWebView *webView;

// This retained instance of WTUIWebViewDelegate will do all the legwork for us.
@property (strong, nonatomic) WTUIWebViewDelegate *wtDelegate;

@end</code></pre></div>




<div class="objective_c-code-sample"><pre><code>- (void)viewDidLoad 
{
    [super viewDidLoad];
    NSURL *url = [NSURL URLWithString:@"https://bank.wt-go.com/invest"];
    
    // If you want to share a session between the app and the website,
    // append it to the URL before triggering the request
    // using the appendSessionParamsToUrl: method below
    NSURL *sessionedUrl = [[WTDataCollector sharedCollector] appendSessionParamsToUrl:url];
    self.wtDelegate = [WTUIWebViewDelegate new];

    // Set our retained WTUIWebViewDelegate as the UIWebView's delegate
    self.webView.delegate = self.wtDelegate;
    [self.webView loadRequest:[NSURLRequest requestWithURL:sessionedUrl]];
}</code></pre></div>


<hr />

<p><span id="method2"></span></p>

<h4>Method 2 – Self-supplied delegate</h4>

<div class="swift-code-sample"><pre><code>@IBOutlet weak var webView: UIWebView!

override func viewDidLoad() {
    super.viewDidLoad()
    let url = NSURL(string: "https://bank.wt-go.com/invest")
    
    // If you want to share a session between the app and the website,
    // append it to the URL before triggering the request
    // using the appendSessionParamsToUrl: method below
    let sessionedUrl = WTDataCollector.sharedCollector().appendSessionParamsToUrl(url)
    
    // Set our retained WTUIWebViewDelegate as the UIWebView's delegate
    webView.delegate = self
        
    webView.loadRequest(NSURLRequest(URL: sessionedUrl))
}

// This method must be present if you're not using a retained instance of WTUIWebViewDelegate
func webView(webView: UIWebView, shouldStartLoadWithRequest request: NSURLRequest, navigationType: UIWebViewNavigationType) -> Bool {
    if (!WTWebViewDelegate.shouldStartLoadWithRequest(request)) {
        return false
    }
    //Any custom logic here  
    return true
}</code></pre></div>




<div class="objective_c-code-sample"><pre><code>- (void)viewDidLoad 
{
    [super viewDidLoad];
    NSURL *url = [NSURL URLWithString:@"https://bank.wt-go.com/invest"];
    // If you want to share a session between the app and the website,
    // append it to the URL before triggering the request
    // using the appendSessionParamsToUrl: method below
    NSURL *sessionedUrl = [[WTDataCollector sharedCollector] appendSessionParamsToUrl:url];
    // If you do this, you must implement webView:ShouldStartLoadWithRequest:navigationType
    self.webView.delegate = self
    [self.webView loadRequest:[NSURLRequest requestWithURL:sessionedUrl]];
}
// This method must be present if you're not using a retained instance of WTUIWebViewDelegate
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    if (![WTWebViewDelegate shouldStartLoadWithRequest:request]) 
    {
        return NO;
    }
    //Any custom logic here
    return YES;
}</code></pre></div>


<h3>Using WKWebview</h3>

<p>When using WKWebview, conform to WKNavigationDelegate, and implement -webView:decidePolicyForNavigationAction:decisionHandler:
Include the following inside your method:</p>

<div class="swift-code-sample"><pre><code>func webView(webView: WKWebView, decidePolicyForNavigationAction navigationAction: WKNavigationAction, decisionHandler: (WKNavigationActionPolicy) -> Void) {
    let shouldStart = WTWebViewDelegate.shouldStartLoadWithRequest(navigationAction.request)
    if !shouldStart {
        decisionHandler(.Cancel)
        return
    }
    // Any custom decision policy code. Make sure your code calls decisionHandler with your chosen action policy.
}

</code></pre></div>




<div class="objective_c-code-sample"><pre><code>- (void)webView:(WKWebView *)webView decidePolicyForNavigationAction:(WKNavigationAction *)navigationAction decisionHandler:(void (^)(WKNavigationActionPolicy))decisionHandler
{
    BOOL shouldStart = [WTWebViewDelegate shouldStartLoadWithRequest:navigationAction.request];
    if (!shouldStart)
    {
        decisionHandler(WKNavigationActionPolicyCancel);
        return;
    }
    // Any custom decision policy code. Make sure your code calls decisionHandler with your chosen action policy.
}
</code></pre></div>


					<footer>
						<div class="footer-copyright">
							
							<p class="copyright">Copyright &copy; 2015 Webtrends. All rights reserved. Updated: 2015-12-14</p>
							
							
							<p class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.2.1 (build 1333)</a>.</p>
							
						</div>
					</footer>
				</main>
			</div>
		</div>
	</article>

	<script src="../../js/script.js"></script>
</body>
</html>